# KW APPS - AI-Powered Arabic Website Builder Platform

**Version**: 2.0
**Last Updated**: 2025-11-30
**Status**: Production

---

## ğŸ“‹ PROJECT OVERVIEW

KW APPS is an Arabic-first website builder platform that enables users to create professional websites using AI-powered code generation. The platform combines natural language processing, automated code generation, and deployment automation to make web development accessible to Arabic-speaking users.

### Core Features

- **Arabic-First AI Generation**: DeepSeek-powered code generation from Arabic prompts
- **RTL-Native Interface**: Fully right-to-left compliant builder and dashboard
- **Real-Time Preview**: Live sandbox preview of generated applications
- **One-Click Deployment**: Automated deployment to Vercel
- **Multi-Agent Collaboration**: Specialized AI agents for design, development, and operations
- **Usage-Based Pricing**: Freemium model with tiered subscriptions

---

## ğŸ—ï¸ SYSTEM ARCHITECTURE

### Technology Stack

| Layer | Technology | Purpose |
|-------|------------|---------|
| **Frontend** | Next.js 16 (App Router) | React framework with server components |
| **Styling** | Tailwind CSS + shadcn/ui | Utility-first CSS with component library |
| **Backend** | Next.js API Routes | Server-side logic and API endpoints |
| **Database** | Supabase (PostgreSQL) | Data persistence, auth, storage |
| **AI Engine** | DeepSeek API | Code generation (deepseek-chat, deepseek-coder) |
| **Deployment** | Vercel | Hosting, CI/CD, edge functions |
| **Agent System** | Custom Multi-Agent Framework | Specialized AI agents for development tasks |

### Project Structure

```
kwapps/
â”œâ”€â”€ prompts/                          # Master UI prompt files
â”‚   â”œâ”€â”€ master-ui-website.md          # Internal UI guidelines
â”‚   â””â”€â”€ master-ui-deepseek-client.md  # Client app UI guidelines
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                          # Next.js 16 App Router
â”‚   â”‚   â”œâ”€â”€ (auth)/                   # Authentication pages
â”‚   â”‚   â”œâ”€â”€ (marketing)/              # Landing, pricing, blog
â”‚   â”‚   â”œâ”€â”€ admin/                    # Admin dashboard
â”‚   â”‚   â”œâ”€â”€ builder/                  # AI builder interface
â”‚   â”‚   â”œâ”€â”€ dashboard/                # User dashboard
â”‚   â”‚   â””â”€â”€ api/                      # API routes
â”‚   â”‚       â”œâ”€â”€ generate/             # DeepSeek code generation
â”‚   â”‚       â”œâ”€â”€ projects/             # Project CRUD
â”‚   â”‚       â”œâ”€â”€ auth/                 # Supabase auth
â”‚   â”‚       â””â”€â”€ agents/               # Multi-agent system API
â”‚   â”‚
â”‚   â”œâ”€â”€ components/                   # React components
â”‚   â”‚   â”œâ”€â”€ ui/                       # shadcn/ui components
â”‚   â”‚   â”œâ”€â”€ magicui/                  # Magic UI animations
â”‚   â”‚   â”œâ”€â”€ builder/                  # Builder-specific components
â”‚   â”‚   â”œâ”€â”€ dashboard/                # Dashboard components
â”‚   â”‚   â””â”€â”€ admin/                    # Admin components
â”‚   â”‚
â”‚   â”œâ”€â”€ lib/                          # Core library code
â”‚   â”‚   â”œâ”€â”€ supabase/                 # Supabase client utilities
â”‚   â”‚   â”œâ”€â”€ deepseek/                 # DeepSeek API client
â”‚   â”‚   â”‚   â”œâ”€â”€ client.ts             # API wrapper
â”‚   â”‚   â”‚   â””â”€â”€ master-ui-prompt.ts   # UI system prompt
â”‚   â”‚   â”œâ”€â”€ prompts/                  # Master UI prompt (TS export)
â”‚   â”‚   â”œâ”€â”€ components/               # Component registry
â”‚   â”‚   â””â”€â”€ agents/                   # Multi-agent system
â”‚   â”‚       â”œâ”€â”€ core/                 # Base classes, types
â”‚   â”‚       â”œâ”€â”€ prompts/              # Agent system prompts
â”‚   â”‚       â”œâ”€â”€ communication/        # Message bus
â”‚   â”‚       â”œâ”€â”€ agents/               # Specialized agents
â”‚   â”‚       â””â”€â”€ orchestrator/         # Agent coordination
â”‚   â”‚
â”‚   â”œâ”€â”€ types/                        # TypeScript type definitions
â”‚   â””â”€â”€ middleware.ts                 # Next.js middleware
â”‚
â”œâ”€â”€ supabase/                         # Supabase configuration
â”‚   â””â”€â”€ migrations/                   # Database migrations
â”‚
â””â”€â”€ public/                           # Static assets
```

---

## ğŸ¨ MASTER UI SYSTEM â­

### Overview

KW APPS uses a **dual Master UI prompt system** to ensure consistent, high-quality design across all user touchpoints:

1. **Internal UI** (KW APPS website and platform)
2. **Client Apps** (generated by DeepSeek for end users)

This system is the foundation of KW APPS brand identity and user experience quality.

---

### Master UI Prompt Files

#### ğŸ“„ `/prompts/master-ui-website.md`

**Purpose**: UI guidelines for all KW APPS internal platform components

**Applies to**:
- Landing page
- Builder interface
- User dashboard
- Analytics pages
- Blog
- Pricing page
- Account/settings pages
- Admin panels

**Key Requirements**:
- **RTL & Arabic**: All text in Arabic, `dir="rtl"` on root elements
- **Cairo Font**: Exclusively for Arabic typography (weights: 300, 400, 600, 700, 800)
- **Color Palette**: Slate-900 (#0f172a) + Blue-500 (#3b82f6) only
- **Components**: shadcn/ui + Magic UI + Lucide React icons **ONLY**
- **Forbidden**: 21st.dev, Material-UI, purple gradients, AI slop patterns
- **Spacing**: 8px grid system (8, 16, 24, 32, 48, 64px)
- **Accessibility**: WCAG AA minimum, semantic HTML, Arabic ARIA labels

#### ğŸ“„ `/prompts/master-ui-deepseek-client.md`

**Purpose**: UI guidelines for client applications generated by DeepSeek AI

**Applies to**:
- All user-requested apps (restaurant sites, portfolios, e-commerce, etc.)
- Preview sandbox rendered apps
- Deployed client projects

**Key Requirements**:
- **Bold Aesthetics**: Choose ONE clear direction per app, avoid AI slop
- **Typography**: Cairo for Arabic, expressive character-rich fonts for other languages
- **Color & Theme**: High-contrast dominant colors, avoid purple/indigo gradients
- **Motion**: Purposeful animations with Framer Motion, staggered reveals
- **Backgrounds**: Layered gradients, noise textures, depth (not flat)
- **Mandate**: Be unexpected, unique, custom-designed feeling

---

### Integration Points

The Master UI system integrates with every layer of the platform:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USER REQUEST                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   KWAPPS-CHIEF Agent   â”‚
        â”‚  (Determines UI Type)  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚
        â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Internal UI  â”‚       â”‚  Client App  â”‚
â”‚  (website.md) â”‚       â”‚ (client.md)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                      â”‚
        â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DESIGN Agent  â”‚       â”‚ DESIGN Agent â”‚
â”‚ (creates spec)â”‚       â”‚(creates spec)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                      â”‚
        â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DEV Agent    â”‚       â”‚  DEV Agent   â”‚
â”‚ (implements)  â”‚       â”‚(implements)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                      â”‚
        â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GUARD Agent   â”‚       â”‚ GUARD Agent  â”‚
â”‚ (validates)   â”‚       â”‚ (validates)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  OPS Agent    â”‚
           â”‚  (deploys)    â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### When to Use Each Prompt

| Scenario | Prompt File | Agent Instruction |
|----------|-------------|-------------------|
| Building KW APPS internal feature | `master-ui-website.md` | "Follow /prompts/master-ui-website.md" |
| Generating client app for user | `master-ui-deepseek-client.md` | "Follow /prompts/master-ui-deepseek-client.md" |
| Admin dashboard component | `master-ui-website.md` | "Follow /prompts/master-ui-website.md" |
| User's restaurant website | `master-ui-deepseek-client.md` | "Follow /prompts/master-ui-deepseek-client.md" |
| Builder interface redesign | `master-ui-website.md` | "Follow /prompts/master-ui-website.md" |
| User's portfolio site | `master-ui-deepseek-client.md` | "Follow /prompts/master-ui-deepseek-client.md" |

---

## ğŸ”„ INTERCONNECTIVITY & PIPELINE RULES

### 7-Stage DeepSeek Generation Pipeline

The platform uses a sophisticated AI pipeline to transform Arabic prompts into production-ready React applications:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. TRANSLATORâ”‚  Arabic â†’ English
â”‚  (deepseek-  â”‚  Temperature: 0.3 (accurate translation)
â”‚   chat)      â”‚  Preserves: technical terms, design intent
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  **LOADS UI PROMPT HERE** âœ¨
â”‚ 2. ARCHITECTâ”‚  File structure + component plan
â”‚  (deepseek-  â”‚  Prompt: /prompts/master-ui-[type].md
â”‚   chat)      â”‚  Output: Component tree, imports, structure
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  **APPLIES UI RULES HERE** âœ¨
â”‚ 3. GENERATORâ”‚  React/TypeScript code
â”‚  (deepseek-  â”‚  Enforces: Cairo font, RTL, Tailwind, shadcn/ui
â”‚   coder)     â”‚  Output: Complete component code
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚4. ARABIC/RTLâ”‚  RTL compliance check
â”‚    FIXER    â”‚  Adds: dir="rtl", text-right, mr/pr classes
â”‚  (deepseek-  â”‚  Validates: Cairo font, Arabic text
â”‚   chat)      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. SECURITY â”‚  Vulnerability scan
â”‚    FIXER    â”‚  Removes: eval(), dangerouslySetInnerHTML
â”‚  (deepseek-  â”‚  Blocks: external APIs, unsafe patterns
â”‚   chat)      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. VALIDATORâ”‚  Final quality check
â”‚  (deepseek-  â”‚  Checks: RTL, security, Master UI compliance
â”‚   chat)      â”‚  Returns: "PASS" or list of issues
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  7. BUILDER â”‚  Compile & render
â”‚   (Next.js)  â”‚  Sandboxed iframe preview
â”‚              â”‚  Ready for deployment
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### UI Prompt Loading Rules

The DeepSeek client automatically loads the appropriate Master UI prompt based on generation type:

```typescript
// In /src/lib/deepseek/client.ts

async function generateReactCode(params: {
  englishPrompt: string
  arabicPrompt: string
  generationType?: 'client_app' | 'internal_ui'
}): Promise<{ code: string, tokensUsed: number }> {

  // Load appropriate UI prompt
  const uiPromptFile = params.generationType === 'internal_ui'
    ? 'master-ui-website.md'
    : 'master-ui-deepseek-client.md'

  const uiPrompt = await loadPromptFile(`/prompts/${uiPromptFile}`)

  // Inject into system prompt
  const systemPrompt = `${uiPrompt}\n\n${MASTER_UI_SYSTEM_PROMPT}`

  // Generate code with DeepSeek
  const completion = await deepseek.chat.completions.create({
    model: 'deepseek-coder',
    messages: [
      { role: 'system', content: systemPrompt },
      { role: 'user', content: params.englishPrompt }
    ],
    // ... other params
  })

  return { code, tokensUsed }
}
```

### Technology Stack Integration

#### Supabase
- **Database**: PostgreSQL with Row Level Security (RLS)
- **Authentication**: Email/password, OAuth providers
- **Storage**: File uploads for project assets
- **Real-time**: Live preview updates
- **Migrations**: Versioned schema changes in `/supabase/migrations/`

#### Next.js 16
- **App Router**: File-based routing with server components
- **Server Components**: Default for performance
- **Client Components**: `'use client'` directive for interactivity
- **API Routes**: `/app/api/` for backend logic
- **Middleware**: Authentication, redirects, headers

#### Vercel
- **Hosting**: Edge network deployment
- **CI/CD**: Automatic deployments from Git
- **Preview**: Unique URLs for every branch
- **Analytics**: Real-time performance monitoring
- **Environment Variables**: Secure config management

#### DeepSeek API
- **Models**:
  - `deepseek-chat`: Translation, architecture, validation ($0.14/$0.28 per 1M tokens)
  - `deepseek-coder`: Code generation ($0.14/$0.28 per 1M tokens)
- **Base URL**: `https://api.deepseek.com`
- **OpenAI-Compatible**: Uses OpenAI SDK
- **Streaming**: Not currently implemented (future enhancement)

#### Tailwind CSS
- **Utility-First**: Class-based styling
- **RTL Support**: Built-in with `dir` attribute
- **Custom Config**: Brand colors, spacing scale, typography
- **JIT Mode**: On-demand CSS generation
- **Purging**: Removes unused classes in production

#### shadcn/ui
- **Component Library**: Copy-paste component system
- **Customizable**: Full control over component code
- **Accessible**: WCAG AA compliant
- **Radix UI**: Built on Radix primitives
- **Tailwind-Based**: Uses Tailwind for styling

#### Magic UI
- **Animation Components**: BlurFade, AnimatedBeam, ShimmerButton, etc.
- **Framer Motion**: Powered by Framer Motion
- **Performance**: GPU-accelerated animations
- **Customizable**: Adjustable delays, durations, easings

---

### Agent Collaboration Flow

The multi-agent system orchestrates development tasks through specialized agents:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          USER REQUEST (Arabic)              â”‚
â”‚   "Ø£Ø±ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ Ù„Ù…Ø·Ø¹Ù… Ù…Ø¹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ø¹Ø§Ù…"        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   KWAPPS-CHIEF       â”‚
        â”‚   (Coordinator)      â”‚
        â”‚                      â”‚
        â”‚  1. Analyzes request â”‚
        â”‚  2. Creates task planâ”‚
        â”‚  3. Delegates work   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚            â”‚            â”‚
      â–¼            â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DESIGN  â”‚  â”‚   DEV   â”‚  â”‚  GUARD  â”‚
â”‚         â”‚  â”‚         â”‚  â”‚         â”‚
â”‚ Creates â”‚  â”‚Implementsâ”‚ â”‚Validatesâ”‚
â”‚ UI spec â”‚â†’ â”‚  code   â”‚â†’ â”‚ quality â”‚
â”‚         â”‚  â”‚         â”‚  â”‚         â”‚
â”‚Follows: â”‚  â”‚Follows: â”‚  â”‚Enforces:â”‚
â”‚website  â”‚  â”‚website  â”‚  â”‚website  â”‚
â”‚  .md    â”‚  â”‚  .md    â”‚  â”‚  .md    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚   OPS   â”‚
                          â”‚         â”‚
                          â”‚ Deploys â”‚
                          â”‚to Vercelâ”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Message Flow**:
1. CHIEF receives user request
2. CHIEF delegates to DESIGN: "Create UI spec following /prompts/master-ui-deepseek-client.md"
3. DESIGN sends spec to DEV
4. DEV implements and notifies GUARD
5. GUARD validates and approves/rejects
6. If approved, OPS deploys

---

## ğŸ¤– MULTI-AGENT SYSTEM

### Agent Types

| Agent | Role | Model | Capabilities |
|-------|------|-------|--------------|
| **KWAPPS-CHIEF** | Supervisor & Coordinator | deepseek-chat | Planning, delegation, approval, conflict resolution |
| **KWAPPS-DESIGN** | UI/UX Specialist | deepseek-chat | UI specs, Arabic content, brand validation |
| **KWAPPS-DEV** | Full-Stack Engineer | deepseek-coder | Code implementation, testing, refactoring |
| **KWAPPS-OPS** | DevOps Specialist | deepseek-chat | Deployment, monitoring, infrastructure |
| **KWAPPS-GUARD** | QA & Security | deepseek-chat | Security scan, RTL validation, quality checks |

### Agent Communication

Agents communicate through a **priority message bus** with persistent history:

```typescript
interface AgentMessage {
  id: string
  session_id: string
  from_agent: 'chief' | 'design' | 'dev' | 'ops' | 'guard' | 'user'
  to_agent?: string // null = broadcast
  message_type: 'TASK_DELEGATION' | 'REQUEST_APPROVAL' | 'BROADCAST_UPDATE' | 'DIRECT_MESSAGE' | 'STATUS_UPDATE' | 'ERROR_REPORT'
  content: string
  priority: number
  read_at?: string
  created_at: string
}
```

**Message Priorities**:
- ERROR_REPORT: 10 (highest)
- REQUEST_APPROVAL: 8
- USER_MESSAGE: 7
- TASK_DELEGATION: 5
- STATUS_UPDATE: 3
- DIRECT_MESSAGE: 2
- BROADCAST_UPDATE: 1 (lowest)

### Agent System Prompts

Each agent has a detailed system prompt that references the Master UI files:

- `/src/lib/agents/prompts/chief-prompt.ts` â†’ Coordinator instructions
- `/src/lib/agents/prompts/design-prompt.ts` â†’ **References master-ui-*.md files**
- `/src/lib/agents/prompts/dev-prompt.ts` â†’ **References master-ui-*.md files**
- `/src/lib/agents/prompts/ops-prompt.ts` â†’ Deployment & infrastructure
- `/src/lib/agents/prompts/guard-prompt.ts` â†’ **Enforces master-ui-*.md compliance**

---

## ğŸ—„ï¸ DATABASE SCHEMA

### Core Tables

```sql
-- Users
users (
  id UUID PRIMARY KEY,
  email TEXT UNIQUE NOT NULL,
  name TEXT,
  plan TEXT NOT NULL, -- 'free', 'builder', 'pro', 'hosting_only'
  created_at TIMESTAMPTZ DEFAULT NOW()
)

-- Projects
projects (
  id UUID PRIMARY KEY,
  user_id UUID REFERENCES users(id),
  name TEXT NOT NULL,
  arabic_prompt TEXT,
  english_prompt TEXT,
  generated_code TEXT,
  status TEXT, -- 'draft', 'preview', 'deployed'
  deployment_url TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW()
)

-- Messages (chat history)
messages (
  id UUID PRIMARY KEY,
  project_id UUID REFERENCES projects(id),
  role TEXT NOT NULL, -- 'user', 'assistant'
  content TEXT NOT NULL,
  tokens_used INTEGER,
  created_at TIMESTAMPTZ DEFAULT NOW()
)

-- Usage Limits
usage_limits (
  user_id UUID REFERENCES users(id),
  date DATE NOT NULL,
  prompt_count INTEGER DEFAULT 0,
  tokens_used INTEGER DEFAULT 0,
  PRIMARY KEY (user_id, date)
)

-- Agent System Tables (7 tables)
agent_sessions, agent_tasks, agent_messages,
agent_decisions, agent_state_snapshots,
agent_metrics, agent_prompt_cache
```

---

## ğŸš€ DEVELOPMENT WORKFLOW

### Local Development

```bash
# Install dependencies
npm install

# Set up environment variables (.env.local)
DEEPSEEK_API_KEY=your_key_here
NEXT_PUBLIC_SUPABASE_URL=your_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_key
SUPABASE_SERVICE_ROLE_KEY=your_key

# Run development server
npm run dev

# Open http://localhost:3000
```

### Building for Production

```bash
# Type check
npm run type-check

# Lint
npm run lint

# Build
npm run build

# Test production build locally
npm run start
```

### Database Migrations

```bash
# Create new migration
npx supabase migration new migration_name

# Apply migrations
npx supabase db push

# Verify schema
npx supabase db diff
```

---

## ğŸ“¦ DEPLOYMENT

### Vercel Deployment

**Automatic Deployment**:
- Push to `main` branch â†’ Production deployment
- Push to other branches â†’ Preview deployment

**Manual Deployment**:
```bash
npx vercel --prod
```

**Environment Variables** (Set in Vercel dashboard):
- `DEEPSEEK_API_KEY`
- `NEXT_PUBLIC_SUPABASE_URL`
- `NEXT_PUBLIC_SUPABASE_ANON_KEY`
- `SUPABASE_SERVICE_ROLE_KEY`

---

## ğŸ“š RESOURCES

- [Next.js Documentation](https://nextjs.org/docs)
- [Supabase Documentation](https://supabase.com/docs)
- [DeepSeek API Documentation](https://platform.deepseek.com/docs)
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)
- [shadcn/ui Documentation](https://ui.shadcn.com)
- [Master UI Prompt (Website)](/prompts/master-ui-website.md)
- [Master UI Prompt (Client)](/prompts/master-ui-deepseek-client.md)

---

## ğŸ¯ QUALITY STANDARDS

All code must meet:
- âœ… Full RTL and Arabic compliance
- âœ… Cairo font usage for Arabic text
- âœ… Brand color palette (Slate-900 + Blue-500)
- âœ… No AI slop aesthetic patterns
- âœ… Security best practices (no XSS, SQL injection, etc.)
- âœ… Accessibility standards (WCAG AA minimum)
- âœ… Performance optimization (lazy loading, code splitting)
- âœ… TypeScript strict mode
- âœ… ESLint with no errors
- âœ… Master UI prompt compliance (validated by GUARD agent)

---

**For questions or issues, refer to the Master UI prompt files or consult with the multi-agent system.**
